<style>body{margin:0;background:#f6f6f6; display: flex;justify-content: center;align-items: center}
* {box-sizing: border-box}
#win-danmaku-extension .mainer{position:relative;border-radius:6px; font-size:12px;height:600px;background:#fff;padding:10px;box-shadow:4px 6px 20px #0000002b;display: flex }
#win-danmaku-extension input{line-height:24px}#win-danmaku-extension input,#win-danmaku-extension textarea{border:1px solid #ddd;box-shadow:0 0 6px rgba(0,0,0,0.1) inset;color:#555;width:auto;height:auto;margin:0;padding:0 0 0 4px}#win-danmaku-extension .mainer > div{height:100%}#win-danmaku-extension .l{width:320px;}#win-danmaku-extension .l > div{height:100%;display:none;}#win-danmaku-extension .l > div.active{display:block}#win-danmaku-extension .l > .b > .m,#win-danmaku-extension .l > .e > .i > .m,#win-danmaku-extension .l > .d > .m{float:left;margin:0 0 12px 0;padding:0 16px 0 0;}#win-danmaku-extension .l > .b > .m label,#win-danmaku-extension .l > .e > .i > .m label,#win-danmaku-extension .l > .d > .m label{color:#666;padding:4px;background-color:#eee;margin:0 3px}#win-danmaku-extension .l > .b > .m select,#win-danmaku-extension .l > .e > .i > .m select,#win-danmaku-extension .l > .d > .m select{border:1px solid #ddd;min-width:30px;width:80px;margin-top:0;height:26px;box-shadow:0 0 4px rgba(0,0,0,0.05) inset}#win-danmaku-extension .l > .b > .m input,#win-danmaku-extension .l > .e > .i > .m input,#win-danmaku-extension .l > .d > .m input{max-width:60px;box-shadow:0 0 4px rgba(0,0,0,0.05) inset;}#win-danmaku-extension .l > .b > .m input:focus,#win-danmaku-extension .l > .e > .i > .m input:focus,#win-danmaku-extension .l > .d > .m input:focus{color:#333}#win-danmaku-extension .l > .b > .m input[type="checkbox"],#win-danmaku-extension .l > .e > .i > .m input[type="checkbox"],#win-danmaku-extension .l > .d > .m input[type="checkbox"]{width:20px;height:20px;vertical-align:middle;margin:2px 0 4px}#win-danmaku-extension .l > .b > .m.f,#win-danmaku-extension .l > .e > .i > .m.f,#win-danmaku-extension .l > .d > .m.f{position:absolute;top:269px;left:235px}#win-danmaku-extension .l > .b > .m.rnd,#win-danmaku-extension .l > .e > .i > .m.rnd,#win-danmaku-extension .l > .d > .m.rnd{position:absolute;top:124px;left:265px}#win-danmaku-extension .l > .b > .m.vt,#win-danmaku-extension .l > .e > .i > .m.vt,#win-danmaku-extension .l > .d > .m.vt{position:absolute;top:269px;left:136px}#win-danmaku-extension .l > .d{overflow:auto;}#win-danmaku-extension .l > .d .q{margin-left:20px}#win-danmaku-extension .l > .d pre{font-size:12px;line-height:1;padding:8px;padding-left:16px;background-color:#ddd}#win-danmaku-extension .l > .d .n{display:block;font-size:14px;line-height:1.7;color:#333;background-color:#eee;padding:8px;margin-bottom:8px}#win-danmaku-extension .l > .e > .i > .m:last-child{width:100%}#win-danmaku-extension .l > .e > .i > .m textarea{width:100%;height:146px;margin-top:12px;margin-left:3px}#win-danmaku-extension .l > .e > .i > .m select{width:56px}#win-danmaku-extension .l > .e > .i > .m input[disabled="disabled"],#win-danmaku-extension .l > .e > .i > .m select[disabled="disabled"]{background-color:#f3f3f3;cursor:pointer}#win-danmaku-extension .l > .e > .i > .m input{max-width:38px}#win-danmaku-extension .l > .e > .i > .m:nth-child(3n){padding:0}#win-danmaku-extension .l > .f audio{width:100%}#win-danmaku-extension .l > .f > .f{position:absolute;bottom:0}#win-danmaku-extension .l .t{position:absolute;bottom:8px;right:8px;z-index:3;}#win-danmaku-extension .l .t a{display:inline-block;width:72px;text-align:center;border:1px solid #ddd;outline:none;padding:4px 8px;cursor:pointer;color:#666;box-shadow:0 1px 2px rgba(0,0,0,0.1);}#win-danmaku-extension .l .t a:hover{background-color:#fafafa;color:#333}#win-danmaku-extension .l .t a:active{box-shadow:0 1px 2px rgba(0,0,0,0.1) inset}#win-danmaku-extension .r{width:93px;box-shadow:1px 0 2px rgba(0,0,0,0.05) inset;box-sizing:content-box;padding:8px 0 8px 0;position:relative;left:9px;border-left:1px solid #ddd;}#win-danmaku-extension .r > div{width:100%;height:40px;position:relative;left:-1px;border:1px solid #ddd;border-top:0;border-right:0;}#win-danmaku-extension .r > div:first-child{border-top:1px solid #ddd}#win-danmaku-extension .r > div.active{border-left:0;z-index:2;box-shadow:1px 0 2px rgba(0,0,0,0.1);}#win-danmaku-extension .r > div.active:after{display:block;height:100%;width:5px;position:relative;background-color:#fff;left:-3px}#win-danmaku-extension .r > div.active button{background-color:#fff}#win-danmaku-extension .r > div button{width:100%;height:100%;background-color:#f5f5f5;border:0;outline:none;cursor:pointer}#win-danmaku-extension .lrc-editor{width:100%;height:100%;box-sizing:border-box;padding:8px;margin:0;resize:none;}#win-danmaku-extension .lrc-editor::-webkit-scrollbar{width:6px;background-color:#fafafa}#win-danmaku-extension .lrc-editor::-webkit-scrollbar-thumb{background:#d6d6d6;border-radius:3px}input[type="file"]{border:none !important;box-shadow:none !important}
</style><div id="win-danmaku-extension"><div class="mainer"><div class="l"><div class="a active"><textarea id="lrc-editor" spellcheck="false" placeholder="粘贴LRC" class="lrc-editor"></textarea></div><div class="b"><div class="m"><label for="ipt-fontsize-lrc">字号</label><input id="ipt-fontsize-lrc" type="number" value="25" min="1" max="99"/></div><div class="m"><label for="slt-font-lrc">字体</label><select id="slt-font-lrc"><option value="黑体">黑体</option><option value="宋体" selected="selected">宋体</option><option value="楷体">楷体</option><option value="Microsoft JhengHei">楷体</option><option value="微软雅黑">微软雅黑</option><option value="新宋体">新宋体</option></select></div><div class="m"><label for="ipt-color-lrc">颜色</label><input id="ipt-color-lrc" type="text" value="FFFFFF"/></div><div class="m"><label for="ipt-bcolor-lrc">描边颜色</label><input id="ipt-bcolor-lrc" type="text" value="000000"/></div><div class="m"><label for="ipt-positiony-lrc">位置Y</label><input id="ipt-positiony-lrc" type="text" value="940"/></div><div class="m"><label for="ipt-fadetime-lrc">渐隐</label><input id="ipt-fadetime-lrc" type="text" value="0.3"/></div><div class="m"><label for="ipt-scale-lrc">拉伸</label><input id="ipt-scale-lrc" type="text" value="0.8"/></div><div class="m"><label for="ipt-bold-lrc">加粗</label><input id="ipt-bold-lrc" type="checkbox"/></div><div class="m"><label for="ipt-filter-lrc">滤镜</label><input id="ipt-filter-lrc" type="text" style="max-width:120px" value="[[1,0,1,2,2,8,2,false,false]]"/></div><span class="clearfix"></span><div class="t"><a id="download-danmaku" class="no-select">下载弹幕</a></div></div><div class="c"><div class="i"><input id="ipt-file-ass" type="file"/></div><div class="t"><a id="btn-down-ass">转换弹幕</a></div></div><div class="e"><div class="i"><div class="m"><label for="slt-position-an">锚点</label><select id="slt-position-an"><option value="0">左上</option><option value="1">中上</option><option value="2">右上</option><option value="3">左中</option><option value="4" selected="selected">中中</option><option value="5">右中</option><option value="6">左下</option><option value="7">中下</option><option value="8">右下</option></select></div><div class="m"><label for="ipt-font-an">字体</label><input id="ipt-font-an" type="text" value="宋体"/></div><div class="m"><label for="ipt-size-an">字号</label><input id="ipt-size-an" type="number" value="25" min="1" max="100"/></div><div class="m"><label for="ipt-color-an">颜色</label><input id="ipt-color-an" type="text" value="FFFFFF"/></div><div class="m"><label for="slt-mix-an">混合</label><select id="slt-mix-an" disabled="disabled"><option value="0">正常</option><option value="1">颜色相乘</option><option value="2">反色相乘</option><option value="3">变亮</option><option value="4">变暗</option><option value="5">差值加亮</option><option value="6">实色混合</option><option value="7">差值</option><option value="8">滤色</option><option value="9">覆盖</option><option value="10">强光</option></select></div><div class="m"><label for="ipt-zindex-an">优先级</label><input id="ipt-zindex-an" type="number" value="0" min="0" max="100" disabled="disabled"/></div><div class="m"><label for="ipt-alpha-an">透明度</label><input id="ipt-alpha-an" type="text" value="0"/></div><div class="m"><label for="ipt-filter-an">滤镜</label><input id="ipt-filter-an" type="text" value="[[1,0,1,2,2,8,2,false,false]]" disabled="disabled" style="max-width:80px"/></div><div style="padding-right:0" class="m"><label for="ipt-bold-an">加粗</label><input id="ipt-bold-an" type="checkbox"/></div><div class="m"><label>位置</label><label for="ipt-px-an">x</label><input id="ipt-px-an" type="text" value="500"/><label for="ipt-py-an">y</label><input id="ipt-py-an" type="text" value="940"/><label for="ipt-pz-an">z</label><input id="ipt-pz-an" type="text" value="0" disabled="disabled"/></div><div class="m"><label>旋转</label><label for="ipt-rx-an">x</label><input id="ipt-rx-an" type="text" value="0" disabled="disabled"/><label for="ipt-ry-an">y</label><input id="ipt-ry-an" type="text" value="0" disabled="disabled"/><label for="ipt-rz-an">z</label><input id="ipt-rz-an" type="text" value="0" disabled="disabled"/></div><div class="m"><label>拉伸</label><label for="ipt-sx-an">x</label><input id="ipt-sx-an" type="text" value="0.8" disabled="disabled"/><label for="ipt-sy-an">y</label><input id="ipt-sy-an" type="text" value="0.8" disabled="disabled"/><label for="ipt-sz-an">z</label><input id="ipt-sz-an" type="text" value="0" disabled="disabled"/></div><div class="m"><label for="ipt-time-an">间隔时间</label><input id="ipt-time-an" type="text" value="0.03"/></div><div class="m"><label for="slt-type-an">类型</label><select id="slt-type-an"><option value="1">拆分</option><option value="2">填充空格</option><option value="3">逐句</option></select></div><div class="m"><label for="ipt-spacing-an">间距</label><input id="ipt-spacing-an" type="text" value="35" style="max-width:32px"/></div><div class="m f"><label for="ipt-delay-an">延时</label><input id="ipt-delay-an" type="text" value="0.3"/></div><div class="m rnd"><label for="ipt-rnd-an">乱序</label><input id="ipt-rnd-an" type="checkbox"/></div><div class="m vt"><label for="ipt-vt-an">竖向排列</label><input id="ipt-vt-an" type="checkbox"/></div><div class="m"><label for="txt-actions-an">动作列表</label><textarea id="txt-actions-an" spellcheck="false" placeholder="动作列表" style="width:308px">AP->1;LF:0.3;
LF:100;
AP->0;LF:0.3;</textarea></div><span class="clearfix"></span><div class="t"><a id="download-danmaku-an" class="no-select">下载弹幕</a></div></div></div><div class="f"><div class="m"><audio id="audio-lrc-au" controls="controls"></audio></div><div class="m"><label for="ipt-file-au">选择文件</label><input id="ipt-file-au" type="file"/></div><div class="m"><label for="ipt-str-au">字符</label><input id="ipt-str-au" type="text" value="█"/></div><div class="m"><label for="ipt-space-au">间距</label><input id="ipt-space-au" type="text" value="5"/></div><div class="m"><label for="ipt-asy-au">拉伸范围</label><input id="ipt-asy-au" type="text" value="5"/></div><div class="m"><button id="btn-al-au" class="btn">开始收集数据</button></div><div class="m f"><canvas id="canvas-lrc-au" width="320" height="120"></canvas></div></div><div class="d"><p class="n">F9是插入或替换时间，F10暂停或开始，F8是只插入时间。目前版本只生成居中渐隐渐现字幕。（已失效）</p><p><a href="/lost/danmu-filter.html" target="_blank">滤镜swf</a></p><div class="n"><p>使用代码生成动作列表时，使用 action.list = [] 来传递<br />示例：</p><pre>action.list = [
   {
      l: 0.3,
      t: 1
   },
   {
      l: 3
   },
   {
      l: 0.3,
      t: 0
   }
];</pre><p>两个进阶示例：<a href="/lost/2015-2-23.js" target="_blank">示例1</a><a href="/lost/分散.js" target="_blank">示例2</a></p><p>关于param里的附加参数
param:<br /></p><div class="q">d: 当前lrc文本存活时长，出现时间，文本内容<br />
data: 存放生成弹幕用的属性<br />
pox: 当前lrc文本对应的X轴坐标数组<br />
i: 当前文字处于当前行的位置<br />
n: 当前lrc文本的位置<br />
lrc: 解析后的lrc数组<br />
p：界面上输入的参数<br />
r: 存放弹幕的数组，可以向里面添加自定义弹幕<br />
cache: 用来缓存数据<br /></div></div></div></div><div class="r"><div data-index="0" class="a active"><button>lrc</button></div><div data-index="1" class="b"><button>弹幕</button></div><div data-index="2" class="c"><button>ASS字幕</button></div><div data-index="3" class="e"><button>逐字弹幕</button></div><div data-index="4" class="f"><button>频谱</button></div><div data-index="5" class="d"><button>关于</button></div></div></div><script id="msgboxA"></script><script id="msgboxB"></script></div><script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.js"></script>
<script>window.system = {
  timer: {},
  handle: {},
  al: {},
  func: {pm:()=>{}},
  post: {}
}
$.fn.info=(r)=>{alert(r)}
;(function(){system.func.draw=function(analyser){var canvas=document.getElementById("canvas-lrc-au"),cwidth=canvas.width,cheight=canvas.height-2,meterWidth=4,gap=1,space=meterWidth+gap,capHeight=2,capStyle="orange",meterNum=cwidth/(meterWidth+gap)|0,capYPositionArray=[],ctx=canvas.getContext("2d"),gradient=ctx.createLinearGradient(0,0,0,cheight);gradient.addColorStop(1,"orange");gradient.addColorStop(0,"red");var v=Math.log(22050/50)/Math.log(2)/(meterNum-1);var b=1024/22050;var arrStep=[];for(var i=0;i<meterNum;i++){arrStep.push(50*Math.pow(2,i*v))}var index=Math.round(arrStep[0]*b);var arrIndex=[];for(var i=0;i<meterNum;i++){if(index>=Math.round(arrStep[i]*b)){index++}else{index=Math.round(arrStep[i]*b)}arrIndex.push(index)}system.al.minDecibels=-80;system.al.maxDecibels=-20;var drawMeter=function(){var array=new Uint8Array(analyser.frequencyBinCount);analyser.getByteFrequencyData(array);var step=Math.round(array.length/meterNum);ctx.clearRect(0,0,cwidth,cheight);for(var i=0;i<meterNum;i++){var value=array[arrIndex[i]]/(256/cheight)|0;if(value>cheight){value=cheight}if(capYPositionArray.length<Math.round(meterNum)){capYPositionArray.push(value)}ctx.fillStyle=capStyle;if(value<capYPositionArray[i]){ctx.fillRect(i*space,cheight- --capYPositionArray[i],meterWidth,capHeight)}else{ctx.fillRect(i*space,cheight-value,meterWidth,capHeight);capYPositionArray[i]=value}ctx.fillStyle=gradient;ctx.fillRect(i*space,cheight-value+capHeight,meterWidth,cheight)}system.timer.lrc=requestAnimationFrame(drawMeter)};cancelAnimationFrame(system.timer.lrc);requestAnimationFrame(drawMeter)};(function(){var a,ch,d,e,_results;ch=$("#ipt-player-about");if(!system.handle["clannad-1-1"]){system.handle["clannad-1-1"]=$.parseJSON('["你确定已经做好LRC了吗？", "没有什么可以下载的东西呀。", "难道你只是在点着玩吗？", "就算你这样一直点下去也不会有什么变化的。","我讨厌这座小镇","因为这里充满了想要忘却的回忆","每天去学校听听课 和朋友聊聊天","回到根本不想回去的家","这样下去 以后会有什么改变吗","不一样的生活会到来吗","嗯嗯…","豆沙包","你喜欢这所学校吗","我非常非常喜欢","但是 所有的这一切","都在不断改变着","没见过的女生","她应该不是在问我吧","大概是在问心中的某个人吧","无论是多么愉快的事 还是多么开心的事 一切","所有这一切 都在不断改变着","即使如此 你还会喜欢上这里吗","只要找到不就好了","只要找到下一件愉快和开心的事不就好了吗","喂 走啦","我们开始一起攀登","这长长的 长长的坡道","-------------------","春原你这家伙 有好好反省过吗","你小子竟每天没事就把音响开那么大声","那个 如果不听那个的话 就会提不起干劲啊","开始争球","每天都这样还真不嫌烦啊","冈崎 别在那里光顾着看 快来救我啊","傻气会传染的 我才不要","你这家伙还真是冷血的过分啊","吵死了","给我适可而止吧","真是的","邻居可是直接找我来投诉的啊","宿舍管理员可真是份苦差呢","美佐枝小姐 要是早点来救我就好了","你也有错吧 把这次的事当做教训好好反省一下吧","是…","可恶 橄榄球部的混蛋","那么小的声音别人怎么听的到啊","可恶 橄榄球部的混蛋","刚才的话是谁喊的","你想害死我吗","你这家伙也太胆小了吧","如果一对一的话 我是不会退缩的","但是对方人数也太多了吧","不过等着瞧吧 等到了快要毕业的时候","我会好好的回敬他们的","到那时候 冈崎 我的身后就交给你了","好运 我会把你大卸八块的","别砍我 去砍他们啊","但我和橄榄球部是一伙的啊","什么时候开始的","不 只是在那个时候而已","给我安静点","要我帮你回敬一脚吗","就这样 今天也是如此一成不变的结束了","不好意思 来点茶","哪来的那玩意儿","既没有目标 也没有什么事可以拿出热情","拜托你了","拜托我也不会有啊","无所事事的每一天","这里是已经结束了的世界","什么都不会诞生 什么都不会消逝","连流逝的时间都不曾存在","如果我在寻找着自己的诞生地","那么我觉得我不应该选择这个世界","这个世界里竟然有人","她能够看见我吗","我并没有诞生在这个世界","在已经结束了的世界里孤单一人生活着的少女","在空虚的 静止了的世界里活着的少女","我不知为什么 有点在意她了","冈崎和春原还没有来啊","不知道他们是怎么打算的 就业或是升学考试什么的","毕竟都已经三年级了啊","别管了 别管了","我们才没空去管那种游手好闲的家伙","那 那个 冈崎君","啊 什么事 藤林","冈崎君 你今天也迟到了吧","那又怎么了","那个 我觉得每天都按时来上学比较好","你这话说的好像你是班委一样","不是好像 我本来就是…班长","喂 冈崎 可别把班长弄哭了哦","小心她老姐冲过来哦","没事的 我没有哭","我知道了啦","不过这也得看明天的心情如何了","那 那么 我就来为你占卜一下明天的事好了","因为占卜是我的爱好","喂喂…","冈崎君 明天会迟到","你是想找我吵架的吗","因为牌面是这么显示的 我想占卜结果应该就是这样","这样的到底是什么啊","在来学校的途中 与一位温柔的女性发生了浪漫的相遇","忘记了时间的流逝 所以迟到了","还真是有够具体的啊","这是少女的灵感","喂 冈崎朋也","姐姐","杏","敢欺负我妹妹 胆子不小嘛","你这蠢货","喂 我只是在跟她说话而已啊","是啊 姐姐 我没有被欺负啊","那就算了","椋给你占卜过了吗","嗯 说我明天会与一位温柔的女性发生浪漫的相遇","你那表情是什么意思啊","没什么","你就好好加油吧","好了 去哪儿吃呢","幽灵？","听说出现了哦","遇到那场交通事故的女生的幽灵","会不会是看错了","是真的啦 而且长得还很可爱呢","幽灵呢…","哟 一个人吗","在教室里和朋友们一起吃不是更好吗","豆沙包？","喂 你有在听我说话吗","对不起 因为我现在正在吃饭","是吗","请问 有什么事吗","我是想问 你为什么在这种地方独自吃午饭","你喜欢这所学校吗","一般吧","我非常非常地喜欢","之前还有能和我说话的人和关系很好的老师","但是 现在…","发生了什么事吗","我去年很长的一段时间都在休学","因此 那个…","留级了吗","是的 留级了","认识的人都毕业了","现在的学校里全是我不认识的人","我体会到浦岛太郎的心情了","啊 非常抱歉","跟一个刚刚认识的人说这种话","所以你才那样自言自语吗","没有参加什么社团吗","是的 本来是想加入演剧部的","但是因为我身体很弱 没法好好地出席社团活动","只要尽力参加就行啦 放学后去演剧部看看如何呢","但是…","啊 你看","她们在朝这边看呢","一直无精打采的话可是会交不到朋友的哦","笑着向她们打声招呼吧","好了 微笑一下吧","没有注意到吗","我即使是在教室里也是很不显眼的","怎么了呢","哇 好厉害 暴走族啊","春原 这是怎么一回事","应该是来打架的吧","其他高中的家伙骑着机车进来了","你在别人头上搞什么啊","加油","难道她想要进行说教吗","为什么会发生这种事","因为这里算是小镇里升学率最高的学校","也就会有对此感到不爽的家伙吧","你要去帮忙吗","总不能就这样坐视不理吧","智代同学的话是不用担心的","智代？","你不知道吗","就是今年春天转入二年级的坂上智代同学啊","她非常厉害的","你去帮忙 说不定反而会拖她后腿哦","虽然你们这么说","我不想引起无意义的纷争","在受伤之前消失吧","老老实实回去的话就放过你们","你们没必要让自己受伤吧","别小看我们","（旁观者视点）","别小看我们","哇 好帅","那是什么","刚才的那个人是转学生吧","虽然情况和你差不多 但却这么受欢迎","所以说这个世界是要靠自己的","或许真的是这样吧","随口说说的 我也不是能对别人说教的人呢","那我走了","是 那个…","太感谢你了","我是D班的冈崎朋也","我是B班的古河渚","多多指教","是 请多指教 冈崎朋也同学","喂 冈崎","等会儿陪我一下","合伙骗人？","没错 女生是不可能打赢男生的","是你给了他们钱 让他们输的吧","为了积攒人气","还是说不是钱 而是用那个？","女生真好啊 这样就能让愚蠢的男人听自己的话","是谁啊 那两个人","是三年级的不良少年","我记得是叫春原和冈崎","庆幸吧 我本来不想对同校的学生出手","但是只给你特别待遇","真可爱啊 你逞强时候的样子","其实已经抖个不停了吧","总之想算作正当防卫 出招吧","你可别得意忘形了","去死吧","那个时候 我想起来了","曾经在这个小镇里有个非常厉害 并且非常漂亮的少女","一直在解决那种给普通人添麻烦的坏家伙","有这样的一个传说","麻烦在我被打倒之前说","不要再出现在我面前","可恶","旧校舍的三楼 我记得这里应该是变成文化系的活动室了","她鼓起干劲了吗","炸肉饼？","打扰了","冈崎同学 你来了啊","这只手是什么意思呢","不 没什么","我忘记说了 演剧部在今年三月就中止活动了","听说本来部员就很少","但只是中止的话","也就是说只要符合条件就能再次开始活动","是这样的吗","再加把劲怎么样 我也会帮你的","请问 冈崎同学","为什么你会对我这么亲切呢 我们才认识不久","为什么 到底是为什么呢","好好坐好","那么再见了","嗯 再见","那个 冈崎同学","这个公园对面的面包店就是我家","方便的话 有时间请来我家坐坐","我有兴致的话就去","有人么","没有人在吗","那是这周的新商品","方便的话请吃吃看","古河的姐姐？ 或者是母亲吗？","不用付钱的 因为是卖剩下的东西","而且这个面包的主题是「恬静」","恬静？","那就恭敬不如从命了","里面有放仙贝哦","取名就叫仙贝面包","虽然名字的品味很厉害","但更厉害的是做面包的品味啊","是吧","新创意的胜利","请问 怎么了","不是「怎么了」的问题 我就直说了吧","这是失败作品吧","不好吃吗","虽然味道也有问题 但根本问题是吃起来难度太高了","这样卖剩下也是理所当然的","我的面包是 我的面包是…","等 等一下","卖剩下也是理所当然的啊","有其母必有其女吗","希望至少父亲能正常一点","喂","干什么","情况糟糕透了","你说了不能说的话啊","别啰啰唆唆的 只要一边说着好吃好吃一边吃掉就行了","这是道义 是人情吧","虽然真相一直都是很残酷的","但你这样直截了当地说出来她很可怜吧","这一带的居民吃着她的面包时都说好吃的","这是默认的规矩 是法律","所以你也要遵守","不然的话 就抽死你","你穿着的不是和我家孩子同一所学校的校服吗","难道你是渚的朋友","早点说嘛 笨蛋","对不起 让女儿的朋友看到了难为情的事情","不用在意 早苗","这家伙脑袋看上去不怎么好 估计已经忘记了","是吧","不能对客人说那种话的","为什么会这样","不管怎么说都值得庆祝","渚在新学期就这么快把朋友带回来了啊","而且是男孩子哦 秋生","什么 竟然是男的","到现在才发现吗","说不定是男朋友哦","怎么可能把渚交给这种小白脸","滚吧 滚吧","那么我就走了","你这样还算是个男人吗","是男人的话对喜欢的女人要竭尽全力去抢","虽然如此 但我还是不会交给你","啊 你们已经这么要好了啊","这是理所当然的 怎么能亏待女儿的朋友呢","怎么了 一脸白痴的表情","没 我只是在想不应该和这样的家族扯上关系","已经是能这样相互说一些冷笑话的关系了啊","对了 还没有请教尊姓大名呢","他姓冈崎 叫冈崎朋也","听上去很渺小的名字啊","就改叫冈崎银河吧","不错啊 能叫你银河先生吗","顺便把姓改成大宇宙","大宇宙银河 不错的名字吧","我的名字是冈崎朋也","真是啰嗦的家伙啊","早苗 你有什么好名字吗","是啊 在名字上加点前缀怎么样","不只是巨大 还是超越了时空流逝的存在","也就是「永恒之冈崎朋也」","哦 很不错嘛","以后就那样叫吧 乙醇君","怎么还变了","谢了 到了这里我就认识路了","对不起 留到你这么晚","感觉很不可思议","竟然有这样的家族","关系真是好啊","是吗 我觉得很普通","明天见","是 晚安","一天里 地球和火星的距离缩减到了5575万公里","老爸 要睡的话还是躺下比较好","喂 父亲","真是真是 又给朋也君添麻烦了啊","母亲在我很小的时候就因交通事故去世了","大概因为这个 老爸就沉溺于酒精与赌博之中","整日不务正业","如果您愿意的话","让我带您去吧","这座小镇 愿望实现的地方","END","真不敢相信竟然有人这么无聊。","手指点痛了吧。","niconiconi~niconiconi~"]')}if(localStorage.acLrcEts){try{d=JSON.parse(localStorage.acLrcEts);_results=[];for(a in d){$("#ipt-"+a+"-an").val(d[a]);if(a==="actions"){_results.push($("#txt-"+a+"-an").val(d[a]))}else{_results.push(void 0)}}return _results}catch(_error){e=_error;return console.log(e)}}})();(function(){var editor,key;editor=$("#lrc-editor");key=0;$.extend(system.handle,{insertTime:function(time){var a,b,i,l,n,p,s,t,textArr,tl,tm,ts,val,_i,_j,_len,_len1,_results;t=parseFloat(time)-.05;if(t<0){t=0}p=editor[0].selectionStart;textArr=editor.val().split("\n");l=0;tl=textArr.length;_results=[];for(i=_i=0,_len=textArr.length;_i<_len;i=++_i){a=textArr[i];l=a.length+l+1;if(p<l){tm=t/60|0;ts=(t%60*100|0)/100;tm=tm<10?"0"+tm:tm;ts=ts<10?"0"+ts:ts;ts=ts.toString();if(ts.length<5){if(ts.length<3){ts=ts+".00"}else{ts=ts+"0"}}if(key===119){l+=10}if(key===120){if(!/^\[\d{2,}\:\d{2}\.\d{2}]/.test(a)){l+=10}a=a.replace(/^\[\d{2,}\:\d{2}\.\d{2}]/,"")}if(i===tl-1){textArr[i]="["+tm+":"+ts+"]"+a+"\r\n"}else{textArr[i]="["+tm+":"+ts+"]"+a}val="";for(n=_j=0,_len1=textArr.length;_j<_len1;n=++_j){b=textArr[n];if(n===tl-1){val+=b;break}val+=b+"\r\n"}editor.val(val);editor[0].setSelectionRange(l,l);if(i>tl-4){s=editor.scrollTop()+100;editor.scrollTop(s)}break}else{_results.push(void 0)}}return _results}});return editor.on("keydown",function(e){if(e.which===120||e.which===119){e.preventDefault();key=e.which;return system.func.pm("time")}else if(e.which===121){e.preventDefault();if(system.handle.playing){return system.func.pm("pause")}else{return system.func.pm("play")}}})})();(function(){var a,b,index,mainer,win;win=$("#win-danmaku-extension");mainer=win.children(".mainer");a=mainer.children(".l");b=mainer.children(".r");index=0;return b.on("click","> div",function(){var btn;btn=$(this);if(!btn.hasClass("active")){b.children("div").eq(index).removeClass("active");a.children("div").eq(index).removeClass("active");btn.addClass("active");index=parseInt(btn.data().index);return a.children("div").eq(index).addClass("active")}})})();(function(){var Action,Danmaku,Font,Message,fixNum,sanae,win;fixNum=function(n,l){if(isNaN(n)){return}if(/^(-?\d+)(\.\d+)?$/.test(n)){l=l||2;n=parseFloat(n);n=n.toFixed(l);n=parseFloat(n)}return n};Danmaku=function(param){this.color=isNaN(param.color)?16777215:param.color;this.message=param.message;this.mode=param.mode||"7";this.size=param.size||25;this.stime=fixNum(param.stime,3)||0;this.time=param.time||(new Date).getTime();return this.user=param.user||"261495"};Message=function(param){this.parent=param.parent||void 0;this.name=param.name||void 0;this.a=param.a||0;this.b=param.b||false;this.c=isNaN(param.c)?4:param.c;this.e=param.e;this.f=param.f;this.sz=param.sz;this.k=param.k;this.l=param.l||0;this.bm=param.bm;this.n=param.n;this.p=param.p;this.pz=param.pz;this.dep=param.dep;this.r=param.r;this.rx=param.rx;this.t=param.t||0;this.w=param.w;this.ver=param.ver||2;return this.ovph=param.ovph||false};Font=function(param){this.l=param.l;this.b=param.b||false;return this.f=param.f||"微软雅黑"};Action=function(param){this.c=param.c;this.d=fixNum(param.d);this.rx=fixNum(param.rx);this.e=fixNum(param.e);this.f=fixNum(param.f);this.g=fixNum(param.g);this.sz=fixNum(param.sz);this.l=param.l<0?0:fixNum(param.l,3);this.t=fixNum(param.t);this.v=param.v;this.x=fixNum(param.x);this.y=fixNum(param.y);return this.z=fixNum(param.z)};win=$("#win-danmaku-extension");sanae=win.data();win.data().pts=0;win.data().func={downloadFile:function(fileName,content,link,cb){var a,blob;a=document.createElement("a");a.download='弹幕拿去导入吧.json';blob=new Blob([content]);a.href=URL.createObjectURL(blob);a.click();return a.dispatchEvent(new Event("click"))},getFile:function(id,cb){var f,fr;f=$(id)[0].files;if(f.length){f=f[0];if(/\.ass$/.test(f.name)){fr=new FileReader;fr.onloadend=function(e){return typeof cb==="function"?cb(this.result):void 0};return fr.readAsText(f)}else{return $(id).info("warning::请选择ASS字幕文件。")}}},rndArr:function(n){var a,b,i,t,x,_i,_j,_len,_results;a=new Array(n);t=0;a=function(){_results=[];for(var _i=0;0<=n?_i<n:_i>n;0<=n?_i++:_i--){_results.push(_i)}return _results}.apply(this);for(i=_j=0,_len=a.length;_j<_len;i=++_j){x=a[i];b=parseInt(Math.random()*n);t=x;a[i]=a[b];a[b]=t}return a},rndNum:function(n1,n2){var r;r=Math.random();return((n1-n2)*r+n2).toFixed(3)},getPosX:function(param){var a,atlen,full,func,i,i2,index,lastp,odd,x,_i,_j,_k,_l,_len,_len1,_m,_n,_ref,_ref1,_ref2,_ref3,_ref4,_ref5;func={anchor:4,text:"",spacing:35,vt:false,px:500};$.extend(func,param);atlen=func.text.length;if(atlen%2===0){odd=false}else{odd=true}index=[];if(odd){if(/[‐-～]/.test(func.text[(atlen-1)/2])||func.vt){full=true}index[(atlen-1)/2]=func.px;lastp=func.px;if(atlen>1){for(i2=_i=_ref=(atlen-1)/2-1;_ref<=0?_i<=0:_i>=0;i2=_ref<=0?++_i:--_i){if(/[‐-～]/.test(func.text[i2])||func.vt){if(full){index[i2]=lastp-func.spacing}else{index[i2]=lastp-func.spacing*.75}full=true}else{if(full){index[i2]=lastp-func.spacing*.75}else{index[i2]=lastp-func.spacing*.5}full=false}lastp=index[i2]}}if(/[‐-～]/.test(func.text[(atlen-1)/2])||func.vt){full=true}else{full=false}lastp=func.px;if(atlen>1){for(i2=_j=_ref1=(atlen-1)/2+1,_ref2=atlen-1;_ref1<=_ref2?_j<=_ref2:_j>=_ref2;i2=_ref1<=_ref2?++_j:--_j){if(/[‐-～]/.test(func.text[i2])||func.vt){if(full){index[i2]=lastp+func.spacing}else{index[i2]=lastp+func.spacing*.75}full=true}else{if(full){index[i2]=lastp+func.spacing*.75}else{index[i2]=lastp+func.spacing*.5}full=false}lastp=index[i2]}}}else{full=false;if(/[‐-～]/.test(func.text[atlen/2-1])||func.vt){full=true;lastp=func.px-func.spacing/2}else{lastp=func.px-func.spacing/4}index[atlen/2-1]=lastp;if(atlen>2){for(i2=_k=_ref3=atlen/2-2;_ref3<=0?_k<=0:_k>=0;i2=_ref3<=0?++_k:--_k){if(/[‐-～]/.test(func.text[i2])||func.vt){if(full){index[i2]=lastp-func.spacing}else{index[i2]=lastp-func.spacing*.75}full=true}else{if(full){index[i2]=lastp-func.spacing*.75}else{index[i2]=lastp-func.spacing*.5}full=false}lastp=index[i2]}}full=false;if(/[‐-～]/.test(func.text[atlen/2])||func.vt){full=true;lastp=func.px+func.spacing/2}else{lastp=func.px+func.spacing/4}index[atlen/2]=lastp;if(atlen>2){for(i2=_l=_ref4=atlen/2+1,_ref5=atlen-1;_ref4<=_ref5?_l<=_ref5:_l>=_ref5;i2=_ref4<=_ref5?++_l:--_l){if(/[‐-～]/.test(func.text[i2])||func.vt){if(full){index[i2]=lastp+func.spacing}else{index[i2]=lastp+func.spacing*.75}full=true}else{if(full){index[i2]=lastp+func.spacing*.75}else{index[i2]=lastp+func.spacing*.5}full=false}lastp=index[i2]}}}switch(func.anchor){case 0:case 3:case 6:x=func.px-index[0];for(i=_m=0,_len=index.length;_m<_len;i=++_m){a=index[i];index[i]=a+x}break;case 2:case 5:case 8:x=index[index.length-1]-func.px;for(i=_n=0,_len1=index.length;_n<_len1;i=++_n){a=index[i];index[i]=a-x}}return index},lrcConvert:function(text){var a,arr,b,c,i,lines,o,obj,st,_i,_j,_len,_len1;if(text.trim().length){a=text.split("\n");lines=a.filter(function(x){if(x.length&&/^\[\d+\:\d{2}\.\d{2}\]/.test(x)){return true}else{return false}});c=[];for(_i=0,_len=lines.length;_i<_len;_i++){b=lines[_i];arr=b.match(/^\[(\d+)\:(\d{2}\.\d{2})\](.*)/);st=parseFloat(arr[1])*60+parseFloat(arr[2]);obj={text:$.trim(arr[3]),stime:parseFloat(st.toFixed(3))};c.push(obj)}for(i=_j=0,_len1=c.length;_j<_len1;i=++_j){o=c[i];if(c[i+1]){o.lifeTime=parseFloat((c[i+1].stime-o.stime).toFixed(3))}else{o.lifeTime=5}}return c}},assConvert:function(text){var a,arr,convert,i,index,obj,result,type,_i,_j,_ref,_ref1;if(text&&text.length){arr=text.split("\r\n");index=[];obj={size:{x:null,y:null}};convert=function(param){var a,b,c,d,i,j,n,names,o,x,y,_i,_j,_k,_len,_len1,_len2;if(param.length){switch(param[0]){case"[Script Info]":for(_i=0,_len=param.length;_i<_len;_i++){a=param[_i];if(/PlayResX/.test(a)){x=a.match(/\d+/)}else if(/PlayResY/.test(a)){y=a.match(/\d+/)}}if(x&&y){obj.size.x=1e3/x[0];return obj.size.y=1e3/y[0]}else{return obj.size.x=obj.size.y=1}break;case"[V4+ Styles]":case"[Events]":names=[];for(i=_j=0,_len1=param.length;_j<_len1;i=++_j){a=param[i];if(i===1){b=a.split(":");if(b[0].trim()==="Format"&&b[1]){names=b[1].trim().split(",")}else{break}}else if(i>1&&a.length){b=a.split(":");if(b.length){b[0]=b[0].trim();if(!obj[b[0]]){obj[b[0]]=[]}c=obj[b[0]];if(b.length>2){b.shift();b[1]=b.join(":")}if(b[1]){o={};d=b[1].trim().split(",");if(d.length>names.length){d[names.length-1]=d.slice(names.length-1,d.length).join(",")}for(j=_k=0,_len2=names.length;_k<_len2;j=++_k){n=names[j];if(d[j]){o[n.trim()]=d[j].trim()}}c.push(o)}}}}return names=[]}}};for(i=_i=0,_ref=arr.length;0<=_ref?_i<_ref:_i>_ref;i=0<=_ref?++_i:--_i){a=arr[i].trim();if(a.length){if(/^\[.+\]$/.test(a)){index.push(i)}}}if(index.length){for(i=_j=0,_ref1=index.length;0<=_ref1?_j<_ref1:_j>_ref1;i=0<=_ref1?++_j:--_j){type=arr[index[i]];if(type==="[Events]"||type==="[V4+ Styles]"||type==="[Script Info]"){if(i===index.length-1){result=arr.slice(index[i],arr.length)}else{result=arr.slice(index[i],index[i+1])}convert(result)}}}return obj}},assToDanmaku:function(param){var a,al,align,an,be,cc,danmu,et,fad,frx,fry,frz,fs,fscx,fscy,mColor,move,obj,pos,result,size,st,style,ta,tb,tempColor,tempSize,wk,y,_i,_j,_len,_len1,_ref;if(param){result=[];size=null;style=null;if(param.size){size=param.size}else{size={x:1,y:1}}if(param.Style){style=param.Style}if(param.Dialogue){_ref=param.Dialogue;for(_i=0,_len=_ref.length;_i<_len;_i++){a=_ref[_i];if(!a.Text||!a.Text.length){continue}obj={t:{singlewords:false},d:{size:25,color:16777215},m:{e:.88,f:.88,a:1,p:{x:500,y:930}},f:{f:"微软雅黑",l:JSON.parse("[[1,0,1,1.6,1.6,5,3,false,false]]"),b:false}};if(style){for(_j=0,_len1=style.length;_j<_len1;_j++){y=style[_j];if(y.Name===a.Style.replace("*","")){if(y.Fontname){if(/宋/.test(y.Fontname)){obj.f.f="宋体"}}an=a.Text.match(/\\an?(\d)/);if(an){align=an[1].toString()}else{align=y.Alignment}if(align){switch(align){case"1":case"2":case"3":obj.m.c=parseInt(align)+5;obj.m.p.y=(1e3-y.MarginV*size.y).toFixed(2);if(align==="1"){obj.m.p.x=(y.MarginL*size.x).toFixed(2)}else if(align==="3"){obj.m.p.x=(1e3-y.MarginR*size.x).toFixed(2)}else{obj.m.p.x=500}break;case"4":case"5":case"6":obj.m.c=align-1;obj.m.p.y=(500+y.MarginV*size.y).toFixed(2);if(align==="4"){obj.m.p.x=(y.MarginL*size.x).toFixed(2)}else if(align==="6"){obj.m.p.x=(1e3-y.MarginR*size.x).toFixed(2)}else{obj.m.p.x=500}break;case"7":case"8":case"9":obj.m.c=align-7;obj.m.p.y=(y.MarginV*size.y).toFixed(2);if(align==="7"){obj.m.p.x=(y.MarginL*size.x).toFixed(2)}else if(align==="9"){obj.m.p.x=(1e3-y.MarginR*size.x).toFixed(2)}else{obj.m.p.x=500}}}wk="false";if(y.PrimaryColour){tempColor=y.PrimaryColour.replace("&H","");obj.m.a=((255-parseInt(tempColor.slice(0,2),16))/255).toFixed(2);if(obj.m.a<.1){obj.m.a=.9;wk="false"}mColor=tempColor.slice(2,8);mColor=mColor.slice(4,6)+mColor.slice(2,4)+mColor.slice(0,2);obj.d.color=parseInt(mColor,16)}if(y.BorderStyle==="1"){if(y.OutlineColour){tempColor=y.OutlineColour.replace("&H","");tempSize=y.Outline||1.6;if(tempSize>4){tempSize=1.8}al=((255-parseInt(tempColor.slice(0,2),16))/255).toFixed(2);if(al<.2){al=.9}mColor=tempColor.slice(2,8);mColor=mColor.slice(4,6)+mColor.slice(2,4)+mColor.slice(0,2);obj.f.l="[1,"+parseInt(mColor,16)+","+al+","+tempSize+","+tempSize+",6,3,false,"+wk+"]"}if(y.BackColour&&y.Shadow!=="0"){tempColor=y.BackColour.replace("&H","");tempSize=y.Shadow||2;al=((255-parseInt(tempColor.slice(0,2),16))/255).toFixed(2);mColor=tempColor.slice(2,8);mColor=mColor.slice(4,6)+mColor.slice(2,4)+mColor.slice(0,2);obj.f.l="["+obj.f.l+",[2,0,45,"+parseInt(mColor,16)+","+al+","+tempSize+","+tempSize+",1,3,"+wk+",false,false]]"}else{obj.f.l="["+obj.f.l+"]"}}if(y.Bold!=="0"){obj.f.b=true}if(y.Fontsize){if(y.Fontsize>25){obj.d.size=25}else{obj.d.size=y.Fontsize}}}}}ta=a.Start.match(/(\d+)\:(\d{2})\:(\d{2})\.(\d{2})/);st=(ta[1]*3600+ta[2]*60+parseInt(ta[3])+ta[4]/100).toFixed(3);tb=a.End.match(/(\d+)\:(\d{2})\:(\d{2})\.(\d{2})/);et=(tb[1]*3600+tb[2]*60+parseInt(tb[3])+tb[4]/100).toFixed(3);obj.d.stime=st;obj.m.l=(et-st).toFixed(3);pos=a.Text.match(/\\pos\((\d+?),(\d+?)\)/);if(pos){obj.m.p.x=(pos[1]*size.x).toFixed(2);obj.m.p.y=(pos[2]*size.y).toFixed(2)}fad=a.Text.match(/\\fad\((\d+?),(\d+?)\)/);move=a.Text.match(/\\move\((\d+?),(\d+?),(\d+?),(\d+?)\)/);if(fad){obj.m.l=0;obj.m.a=0;obj.a=[{l:(fad[1]/1e3).toFixed(3),t:1},{l:(et-st-fad[1]/1e3-fad[1]/1e3).toFixed(3)},{l:(fad[2]/1e3).toFixed(3),t:0}]}else if(move){obj.a=[{l:0,x:move[1],y:move[2]},{l:obj.m.l,x:move[3],y:move[4]}];obj.m.l=0}fs=a.Text.match(/\\fs(\d{1,2})/);if(fs&&fs[1]<=25){obj.d.size=parseInt(fs[1])}cc=a.Text.match(/\\c\&H(\w{6})/);if(cc){obj.d.color=parseInt(cc[1].slice(4,6)+cc[1].slice(2,4)+cc[1].slice(0,2),16)}frz=a.Text.match(/\\frz(-?\d{1,3})/);if(frz){obj.m.r=frz[1]*-1}frx=a.Text.match(/\\frx(-?\d{1,3})/);if(frx){obj.m.rx=frx[1]*-1}fry=a.Text.match(/\\fry(-?\d{1,3})/);if(fry){obj.m.k=fry[1]*-1}be=a.Text.match(/\\be(\d)/);if(be){if(obj.f.l){obj.f.l=obj.f.l.slice(0,obj.f.l.length-1)+",[0,1.2,1.2,2]]"}else{obj.f.l="[[0,1.2,1.2,2]]"}}obj.f.l=$.parseJSON(obj.f.l);fscx=a.Text.match(/\\fscx(\d{1,3})/);if(fscx){obj.m.e=fscx[1]/100}fscy=a.Text.match(/\\fscy(\d{1,3})/);if(fscx){obj.m.f=fscy[1]/100}obj.m.n=a.Text.replace(/\{.+?\}/g,"").replace(/\\n/gi,"\n");danmu=sanae.func.createSingleDanmaku(obj);result.push(JSON.stringify(danmu))}}return result}},paramConvert:function(param){var a,ac,action,actions,filter,line,lines,obj,p,r,re,_i,_j,_len,_len1;for(a in param){p=param[a];if(p||p.length){if(/^f\:/.test(p)){param["func-"+a]=p.replace(/^f\:/,"")}switch(a){case"color":if(/,/.test(p)){p=p.toString().trim();r=p.match(/^r\(([\w]+),\s?([\w]+),\s?([\w]+)\)$/);if(r){param["r-color"]=[parseInt(r[1],16),parseInt(r[2],16),parseInt(r[3],16)]}p=16777215}else{p=parseInt(p,16)}break;case"alpha":p=parseFloat(p);if(isNaN(p)){p=1}break;case"px":case"py":case"pz":case"sy":case"sx":case"sz":case"rx":case"ry":case"rz":case"time":case"spacing":case"delay":if(isNaN(p)){p=p.toString().trim();r=p.match(/^r\(([\d\.]+),\s?([\d\.]+),\s?([\d\.]+)\)$/);if(r){param["r-"+a]=[parseFloat(r[1]),parseFloat(r[2]),parseFloat(r[3])];p=parseFloat(r[1])}else{p=0}}else{p=parseFloat(p)}break;case"position":case"type":case"mix":case"size":p=parseInt(p);break;case"filter":filter=void 0;try{filter=JSON.parse(p)}catch(_error){}p=filter;break;case"actions":lines=p.split("\n");re=[];if(!lines[0]||!/LF:\d+/.test(lines[0])){param["func-actions"]=p;break}for(_i=0,_len=lines.length;_i<_len;_i++){line=lines[_i];if(line.length){actions=line.split(";");obj={};for(_j=0,_len1=actions.length;_j<_len1;_j++){action=actions[_j];if(action.length){ac=action.split(/\->|\:/);ac[1]=Number(ac[1]);if(!isNaN(ac[1])){switch(ac[0]){case"X":case"Y":case"SZ":obj[ac[0].toLowerCase()]=ac[1];break;case"COL":obj.c=ac[1];break;case"ROZ":obj.d=ac[1];break;case"ROX":obj.rx=ac[1];break;case"ROY":obj.e=ac[1];break;case"SX":obj.f=ac[1];break;case"SY":obj.g=ac[1];break;case"SZ":obj.sz=ac[1];break;case"AP":obj.t=ac[1];break;case"ME":obj.v=ac[1];break;case"LF":obj.l=ac[1];break;default:null}}}}re.push(obj)}}p=re;break}param[a]=p}else{param[a]=void 0}}return param},readySingleDanmaku:function(lrc,param){var a,act,arr,c,cache,d,danmu,e,funcAction,funcFilter,i,i_lrc,index,j,lc,len,lt,obj,pActions,result,space,word,_i,_j,_k,_l,_len,_len1,_len2,_len3,_len4,_m,_ref,_ref1,_ref2,_ref3;result=[];cache={list:[]};obj={d:{},m:{},f:{},a:[]};param=sanae.func.paramConvert(param);if(!param.spacing){param.spacing=parseFloat((param.size*1.2).toFixed(2))}if(lrc&&lrc.length){obj.d.color=param.color;obj.d.size=param.size;obj.m.a=param.alpha;if(param.alpha===0&&!param.actions){obj.m.a=1}obj.m.p={x:param.px,y:param.py};obj.m.pz=param.pz;obj.m.dep=param.zindex;obj.m.c=param.position;obj.m.f=param.sy;obj.m.e=param.sx;obj.m.sz=param.sz;obj.m.k=param.ry;obj.f.b=param.bold;obj.f.f=param.font;obj.f.l=param.filter;obj.m.bm=param.mix;obj.m.r=param.rz;obj.m.rx=param.rx;for(i_lrc=_i=0,_len=lrc.length;_i<_len;i_lrc=++_i){a=lrc[i_lrc];if(a.text.length){obj.a=[];if(param.actions&&!param["func-actions"]){lc=0;index="none";_ref=param.actions;for(j=_j=0,_len1=_ref.length;_j<_len1;j=++_j){d=_ref[j];if(d.l===100){index=j}else{lc+=d.l}}obj.a=JSON.parse(JSON.stringify(param.actions));obj.a2=JSON.parse(JSON.stringify(param.actions));if(index==="none"){obj.m.l=a.lifeTime-lc}else{lt=a.lifeTime-lc;obj.a[index].l=(lt+(param.delay||0)).toFixed(3)}}len=a.text.length;if(param.rnd){arr=sanae.func.rndArr(len)}if(param.type===2){space=a.text.replace(/[‐-～]/g,"　").replace(/[^‐-～]/g," ");_ref1=a.text;for(i=_k=0,_len2=_ref1.length;_k<_len2;i=++_k){c=_ref1[i];if(c.trim().length){word=space.slice(0,i)+c+space.slice(i+1,len);obj.m.n=word;if(param.rnd){obj.d.stime=a.stime+parseFloat((arr[i]*param.time).toFixed(3))}else{obj.d.stime=a.stime+parseFloat((i*param.time).toFixed(3))}obj.m.l=param.actions?0:a.lifeTime;if(param["func-actions"]){pActions={type:"action",data:obj,i:i,d:a,lrc:lrc,n:i_lrc,r:result,p:param,cache:obj.cache};try{funcAction=new Function("func","param","action",param["func-actions"]);funcAction(this,pActions,cache);obj.a=cache.list}catch(_error){e=_error;$.info("error::"+e.toString());return 0}}if(param["func-filter"]){try{funcFilter=new Function("func",param["func-filter"]);obj.f.l=funcFilter(this)}catch(_error){e=_error;$.info("error::"+e.toString());return 0}}danmu=sanae.func.createSingleDanmaku(obj);result.push(JSON.stringify(danmu))}}}else if(param.type===3){obj.m.n=a.text;obj.d.stime=a.stime;obj.m.l=param.actions?0:a.lifeTime;if(param["func-actions"]){pActions={type:"action",data:obj,d:a,lrc:lrc,n:i_lrc,r:result,p:param,cache:obj.cache};try{funcAction=new Function("func","param","action",param["func-actions"]);funcAction(this,pActions,cache);obj.a=cache.list}catch(_error){e=_error;$.info("error::"+e.toString());return 0}}if(param["func-filter"]){try{funcFilter=new Function("func",param["func-filter"]);obj.f.l=funcFilter(this)}catch(_error){e=_error;$.info("error::"+e.toString());return 0}}danmu=sanae.func.createSingleDanmaku(obj);result.push(JSON.stringify(danmu))}else{obj.d.stime=a.stime;index=this.getPosX({text:a.text,anchor:param.position,px:param.px,spacing:param.spacing,vt:param.vt});_ref2=a.text;for(i=_l=0,_len3=_ref2.length;_l<_len3;i=++_l){c=_ref2[i];word=c;if(word.trim().length){obj.m.n=word;if(param["func-actions"]){pActions={type:"action",data:obj,pox:index,i:i,d:a,lrc:lrc,n:i_lrc,r:result,p:param,cache:obj.cache};try{funcAction=new Function("func","param","action",param["func-actions"]);funcAction(this,pActions,cache);obj.a=cache.list}catch(_error){e=_error;$.info("error::"+e.toString());return 0}}if(param["func-filter"]){try{funcFilter=new Function("func",param["func-filter"]);obj.f.l=funcFilter(this)}catch(_error){e=_error;$.info("error::"+e.toString());return 0}}if(param["r-color"]){obj.d.color=this.rndNum(param["r-color"][1],param["r-color"][2])|0}if(param["r-py"]){obj.m.p.y=this.rndNum(param["r-py"][1],param["r-py"][2])}if(param["r-px"]){obj.m.p.x=this.rndNum(param["r-px"][1],param["r-px"][2])}else{obj.m.p.x=index[i]}if(param.vt){if(param["r-py"]){obj.m.p.x=obj.m.p.y}else{obj.m.p.x=param.py}if(param["r-px"]){obj.m.p.y=obj.m.p.x}else{obj.m.p.y=index[i]}}else{obj.m.p.x=index[i]}if(!param["func-actions"]){_ref3=obj.a;for(j=_m=0,_len4=_ref3.length;_m<_len4;j=++_m){act=_ref3[j];if(typeof act.x!=="undefined"){if(param.vt){act.y=obj.a2[j].x+index[i]}else{act.x=obj.a2[j].x+index[i]}}}}if(!obj.setStime){if(param.rnd&&!param["func-actions"]){obj.d.stime=a.stime+parseFloat((arr[i]*param.time).toFixed(3))}else{obj.d.stime=a.stime+parseFloat((i*param.time).toFixed(3))}}obj.m.l=param.actions?0:a.lifeTime;if(obj.a){danmu=sanae.func.createSingleDanmaku(obj);result.push(JSON.stringify(danmu))}}}}}}}return result},createSingleDanmaku:function(param,cb){var a,actions,d,font,func,m,_i,_len,_ref;func={d:{},m:{},f:{},a:[]};$.extend(func,param);font=new Font(func.f);m=new Message(func.m);m.w=font;if(func.a.length){actions=[];_ref=func.a;for(_i=0,_len=_ref.length;_i<_len;_i++){a=_ref[_i];actions.push(new Action(a))}m.z=actions}d=new Danmaku({message:JSON.stringify(m),stime:func.d.stime,size:func.d.size,color:func.d.color});return d},createDanmu:function(param,callback){var a,actionLifeTime,actions,c,d,font,func,i,lifeTimeIndex,m,result,_i,_j,_len,_len1,_ref,_ref1;func={t:{},d:{},m:{},f:{},a:[]};$.extend(func,param);if(!func.t.singlewords){font=new Font(func.f);m=new Message(func.m);m.w=font;result=[];_ref=func.t.content;for(_i=0,_len=_ref.length;_i<_len;_i++){a=_ref[_i];if(a.text.length){m.n=a.text;actions=[];actionLifeTime=0;lifeTimeIndex=1;_ref1=func.a;for(i=_j=0,_len1=_ref1.length;_j<_len1;i=++_j){c=_ref1[i];if(c.sl){c.l=a.lifeTime;lifeTimeIndex=i}else{actionLifeTime+=c.l}actions.push(new Action(c))}if(actions[lifeTimeIndex].l>actionLifeTime){actions[lifeTimeIndex].l=(actions[lifeTimeIndex].l-actionLifeTime).toFixed(3)}else{actions.splice(lifeTimeIndex,1)}m.z=actions;d=new Danmaku({message:JSON.stringify(m),stime:a.stime,size:func.d.size,color:func.d.color});result.push(JSON.stringify(d))}}return result}},getInfo:function(){var bcolor,bold,color,error,fade,filter,font,obj,pY,scale,size;size=$("#ipt-fontsize-lrc").val();font=$("#slt-font-lrc").val().trim();color=parseInt($("#ipt-color-lrc").val(),16);bcolor=parseInt($("#ipt-bcolor-lrc").val(),16);pY=parseFloat($("#ipt-positiony-lrc").val());fade=parseFloat($("#ipt-fadetime-lrc").val());scale=parseFloat($("#ipt-scale-lrc").val());bold=$("#ipt-bold-lrc")[0].checked;filter=$("#ipt-filter-lrc").val();if(filter.length){try{filter=$.parseJSON(filter)}catch(_error){error=_error;filter=false}}else{filter=$.parseJSON("[[1,"+bcolor+",1,1.6,1.6,8,2,false,false]]")}if(isNaN(bcolor)){bcolor=0}if(isNaN(fade)){fade=.3}if(isNaN(scale)){scale=.88}obj={t:{singlewords:false,content:sanae.func.lrcConvert($("#lrc-editor").val())},d:{size:!isNaN(size)?size:25,color:!isNaN(color)?color:16777215},m:{e:scale,f:scale,p:{x:500,y:!isNaN(pY)?pY:940}},f:{f:font.length?font:"微软雅黑",l:filter?filter:void 0,b:bold},a:[{l:fade,t:1},{sl:true},{l:fade,t:0}]};return obj},getInfoA:function(){var items,obj;obj={};win=$("#win-danmaku-extension");items=win.find(".e .m input, .e .m select, .e .m textarea");items.each(function(){var item;item=$(this);if(item.attr("disabled")!=="disabled"){obj[item.attr("id").match(/\w+\-(\w+)\-\w+/)[1]]=item.val()}obj.bold=$("#ipt-bold-an")[0].checked;obj.rnd=$("#ipt-rnd-an")[0].checked;obj.vt=$("#ipt-vt-an")[0].checked;return true});localStorage.acLrcEts=JSON.stringify(obj);return obj},miao:function(win,obj){var a,i;if(isNaN(win.data().pts)){win.data().pts=0}i=win.data().pts;a=system.handle["clannad-1-1"];$(obj).info("info::"+a[i%a.length]);return win.data().pts++}};$("#download-lrc").on("click",function(){var a,i,text,title;text=$("#lrc-editor").val();if(text.length>5){i=win.data().pts;a=system.handle["clannad-1-1"];title=(system.post.title||a[i%a.length])+".lrc";return win.data().func.downloadFile(title,text,this)}else if(text==="gj"){a=$("#win-danmaku-extension .mainer > .r > .e");if(a.hasClass("hidden")){return a.removeClass("hidden")}}else{return sanae.func.miao(win,this)}});$("#download-danmaku").on("click",function(){var a,content,i,obj,text,title;text=$("#lrc-editor").val();if(text.length>5){obj=sanae.func.getInfo();content=sanae.func.createDanmu(obj);if(content.length){i=win.data().pts;a=system.handle["clannad-1-1"];title=(system.post.title||a[i%a.length])+".json";return sanae.func.downloadFile(title,JSON.stringify(content),this)}else{return sanae.func.miao(win,this)}}else{return sanae.func.miao(win,this)}});$("#download-danmaku-an").on("click",function(){var a,content,i,lrc,obj,text,title;text=$("#lrc-editor").val();if(text.length>5){lrc=sanae.func.lrcConvert(text);obj=sanae.func.getInfoA();content=sanae.func.readySingleDanmaku(lrc,obj);if(content.length){i=win.data().pts;a=system.handle["clannad-1-1"];title=(system.post.title||a[i%a.length])+".json";return sanae.func.downloadFile(title,JSON.stringify(content),this)}else{return sanae.func.miao(win,this)}}else{return sanae.func.miao(win,this)}});$("#btn-down-ass").on("click",function(){var self;self=this;return sanae.func.getFile("#ipt-file-ass",function(text){var a,content,i,obj,title;system.ass=text;obj=sanae.func.assConvert(text);content=sanae.func.assToDanmaku(obj);if(content.length){i=win.data().pts;a=system.handle["clannad-1-1"];title=(system.post.title||a[i%a.length])+".json";content=JSON.stringify(content);return sanae.func.downloadFile(title,content,self)}})});(function(){var d,e;win=$("#win-danmaku-extension");e=win.find('.e .i .m input[disabled="disabled"], .e .i .m select[disabled="disabled"]');d=e.prev("label");return d.on("click",function(){var a,aa,aaa;a=$(this);aa=$("#"+a.attr("for"));aaa=aa.attr("disabled");if(aaa==="disabled"){return aa.attr({disabled:false})}else{return aa.attr({disabled:true})}})})();window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext;return function(){var e,eltA,eltB,evtA,fireEvtA,source;if(!system.audioContext){try{system.audioContext=system.ac=new window.AudioContext;system.al=system.ac.createAnalyser()}catch(_error){e=_error;Console.log("浏览器不支持audioContext");return}}source=system.ac.createMediaElementSource($("#audio-lrc-au")[0]);source.connect(system.al);system.al.connect(system.ac.destination);$("#ipt-file-au").on("change",function(){var files,src;files=this.files;src=URL.createObjectURL(files[0]);$("#audio-lrc-au").attr({src:src});return system.func.draw(system.al)});eltA=document.getElementById("msgboxA");eltB=document.getElementById("msgboxB");evtA=document.createEvent("Event");evtA.initEvent("evtA",true,true);fireEvtA=function(data){eltA.innerText=data;
return eltA.dispatchEvent(evtA)};eltB.addEventListener("evtB",function(){var c,data,r,src;data=JSON.parse(eltB.innerText);if(data.success){r=data.result;c=r.C80||r.C40||r.C30||r.C20||r.C10||r.C00;src=c.files[0].url;$("#audio-lrc-au").attr({src:src});return system.func.draw(system.al)}else{return $.info("warning::"+data.message)}});fireEvtA(system.post.vid);clearInterval(system.timer.pinpu);return $("#btn-al-au").on("click",function(){var a,arrIndex,arrStep,asy,b,btn,color,content,count,d,data,dc,dmCount,fsize,i,index,indexTmp,j,k,l,mix,n,nn,p,player,point,px,py,result,space,str,sx,sy,timeOfAct,title,v,value,_i,_j,_k,_l,_len,_m;btn=$(this);player=$("#audio-lrc-au");p=player[0];if(!btn.hasClass("active")){btn.addClass("active").text("结束");system.handle.arrPinpu=[];player[0].play();return system.timer.pinpu=setInterval(function(){var array,r;array=new Uint8Array(system.al.frequencyBinCount);system.al.getByteFrequencyData(array);r={stime:p.currentTime,data:array};return system.handle.arrPinpu.push(r)},200)}else{clearInterval(system.timer.pinpu);btn.removeClass("active").text("开始");count=30;v=Math.log(22050/50)/Math.log(2)/(count-1);b=1024/22050;arrStep=[];for(a=_i=0;0<=count?_i<=count:_i>=count;a=0<=count?++_i:--_i){arrStep.push(50*Math.pow(2,a*v))}index=Math.round(arrStep[0]*b);arrIndex=[];for(a=_j=0;0<=count?_j<=count:_j>=count;a=0<=count?++_j:--_j){if(index>=Math.round(arrStep[a]*b)){index++}else{index=Math.round(arrStep[a]*b)}arrIndex.push(index)}fsize=$("#ipt-size-an").val()|0;point=$("#slt-position-an").val()|0;px=$("#ipt-px-an").val()|0;py=$("#ipt-py-an").val()|0;sx=parseFloat($("#ipt-sx-an").val());sy=parseFloat($("#ipt-sy-an").val());str=$("#ipt-str-au").val();space=parseFloat($("#ipt-space-au").val());mix=$("#slt-mix-an").val();asy=parseFloat($("#ipt-asy-au").val());color=parseInt($("#ipt-color-an").val(),16);nn=asy/256;data=system.handle.arrPinpu;indexTmp=0;timeOfAct=30;dmCount=parseInt((data[data.length-1].stime-data[0].stime)/timeOfAct)+1;d={d:{color:color,size:fsize,stime:data[0].stime},f:{f:"黑体"},m:{a:1,bm:mix,c:point,k:0,e:sx,f:sy,l:0,n:str,p:{x:px,y:py},dep:7},a:[]};result=[];for(dc=_k=0;0<=dmCount?_k<=dmCount:_k>=dmCount;dc=0<=dmCount?++_k:--_k){if(!data[indexTmp]){break}d.d.stime=data[indexTmp].stime;d.m.p.x=px;for(i=_l=0;0<=count?_l<=count:_l>=count;i=0<=count?++_l:--_l){d.a=[];d.m.p.x+=space;for(n=_m=0,_len=data.length;_m<_len;n=++_m){k=data[n];j=data[indexTmp+n];p=data[indexTmp+n+1];if(!j||j.stime>timeOfAct+data[indexTmp].stime){indexTmp+=n;break}if(p){l=p.stime-j.stime;value=p.data[arrIndex[i]]*nn+sy;a={l:.03,g:value};d.a.push(a);a={l:l-.03,g:value/2};d.a.push(a)}}result.push(JSON.stringify(sanae.func.createSingleDanmaku(d)))}}content=result;if(content.length){title=(system.post.title||"notitle")+".json";return sanae.func.downloadFile(title,JSON.stringify(content),this)}else{return sanae.func.miao(win,this)}}})}()})()}).call(this);
</script>
